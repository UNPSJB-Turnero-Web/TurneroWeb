<div class="container mt-4">
  <div class="card modern-card">
    <!-- HEADER NORMALIZADO CON SISTEMA DE COLORES -->
    <div class="banner-esquema-turno">
      <div class="header-content">
        <div class="title-section">
          <div class="header-icon">
            <i class="fas fa-calendar-check"></i>
          </div>
          <div class="header-text">
            <h1>Esquemas de Turno</h1>
            <p>Gestione los esquemas de turnos para médicos</p>
          </div>
        </div>
        <button
          class="btn btn-new"
          (click)="router.navigate(['/esquema-turno/new'])"
        >
          <i class="fas fa-plus me-2"></i>
          Nuevo Esquema
        </button>
      </div>
    </div>

    <!-- BARRA DE FILTROS -->
    <div class="filters-section">
      <div class="filters-container">
        <div class="filter-group">
          <label for="staffMedicoFilter" class="form-label">
            <i class="fas fa-user-md me-1"></i>
            Staff Médico
          </label>
          <input
            type="text"
            id="staffMedicoFilter"
            class="form-control"
            placeholder="Buscar por nombre..."
            [(ngModel)]="filters.staffMedico"
            (input)="applyFilters()"
          />
        </div>
        <div class="filter-group">
          <label for="consultorioFilter" class="form-label">
            <i class="fas fa-door-open me-1"></i>
            Consultorio
          </label>
          <input
            type="text"
            id="consultorioFilter"
            class="form-control"
            placeholder="Buscar por consultorio..."
            [(ngModel)]="filters.consultorio"
            (input)="applyFilters()"
          />
        </div>
        <div class="filter-group">
          <label for="centroFilter" class="form-label">
            <i class="fas fa-hospital me-1"></i>
            Centro
          </label>
          <input
            type="text"
            id="centroFilter"
            class="form-control"
            placeholder="Buscar por centro..."
            [(ngModel)]="filters.centro"
            (input)="applyFilters()"
          />
        </div>
        <div class="filter-actions">
          <button
            class="btn btn-clear"
            (click)="clearFilters()"
            title="Limpiar filtros"
          >
            <i class="fas fa-times"></i>
            Limpiar
          </button>
        </div>
      </div>
    </div>

    <!-- TABLA MODERNA NORMALIZADA -->
    <div class="table-container">
      <table class="table modern-table">
        <thead>
          <tr>
            <th>
              <button
                class="sortable-header"
                [class.active]="filters.sortBy === 'id'"
                (click)="toggleSort('id')"
              >
                <div class="header-cell">
                  <div class="icon-circle id-header">
                    <i class="fas fa-hashtag"></i>
                  </div>
                  ID
                  <i
                    class="fas fa-sort-up sort-icon"
                    [class.fa-sort-up]="
                      filters.sortBy === 'id' && filters.sortDir === 'asc'
                    "
                    [class.fa-sort-down]="
                      filters.sortBy === 'id' && filters.sortDir === 'desc'
                    "
                    [class.fa-sort]="filters.sortBy !== 'id'"
                  ></i>
                </div>
              </button>
            </th>
            <th>
              <button
                class="sortable-header"
                [class.active]="filters.sortBy === 'staffMedico'"
                (click)="toggleSort('staffMedico')"
              >
                <div class="header-cell">
                  <div class="icon-circle icon-medicos">
                    <i class="fas fa-user-md"></i>
                  </div>
                  Staff Médico
                  <i
                    class="fas fa-sort-up sort-icon"
                    [class.fa-sort-up]="
                      filters.sortBy === 'staffMedico' &&
                      filters.sortDir === 'asc'
                    "
                    [class.fa-sort-down]="
                      filters.sortBy === 'staffMedico' &&
                      filters.sortDir === 'desc'
                    "
                    [class.fa-sort]="filters.sortBy !== 'staffMedico'"
                  ></i>
                </div>
              </button>
            </th>
            <th>
              <button
                class="sortable-header"
                [class.active]="filters.sortBy === 'consultorio'"
                (click)="toggleSort('consultorio')"
              >
                <div class="header-cell">
                  <div class="icon-circle icon-consultorios">
                    <i class="fas fa-door-open"></i>
                  </div>
                  Consultorio
                  <i
                    class="fas fa-sort-up sort-icon"
                    [class.fa-sort-up]="
                      filters.sortBy === 'consultorio' &&
                      filters.sortDir === 'asc'
                    "
                    [class.fa-sort-down]="
                      filters.sortBy === 'consultorio' &&
                      filters.sortDir === 'desc'
                    "
                    [class.fa-sort]="filters.sortBy !== 'consultorio'"
                  ></i>
                </div>
              </button>
            </th>
            <th>
              <button
                class="sortable-header"
                [class.active]="filters.sortBy === 'centro'"
                (click)="toggleSort('centro')"
              >
                <div class="header-cell">
                  <div class="icon-circle icon-centro-atencion">
                    <i class="fas fa-hospital"></i>
                  </div>
                  Centro
                  <i
                    class="fas fa-sort-up sort-icon"
                    [class.fa-sort-up]="
                      filters.sortBy === 'centro' && filters.sortDir === 'asc'
                    "
                    [class.fa-sort-down]="
                      filters.sortBy === 'centro' && filters.sortDir === 'desc'
                    "
                    [class.fa-sort]="filters.sortBy !== 'centro'"
                  ></i>
                </div>
              </button>
            </th>
            <th>
              <div class="header-cell">
                <div class="icon-circle icon-disponibilidad">
                  <i class="fas fa-clock"></i>
                </div>
                Horarios
              </div>
            </th>
            <th>
              <div class="header-cell">
                <div class="icon-circle icon-esquema-turno">
                  <i class="fas fa-stopwatch"></i>
                </div>
                Intervalo
              </div>
            </th>
            <th>
              <div class="header-cell text-center">
                <div class="icon-circle actions-header">
                  <i class="fas fa-cogs"></i>
                </div>
                Acciones
              </div>
            </th>
          </tr>
        </thead>
        <tbody>
          <tr
            *ngFor="let esquema of resultsPage.content || []; let i = index"
            class="table-row"
            (click)="goToDetail(esquema.id)"
            [style.animation-delay]="i * 100 + 'ms'"
          >
            <td>
              <div class="id-badge">
                <span>{{ esquema.id }}</span>
              </div>
            </td>
            <td>
              <div class="staff-info">
                <div class="avatar-medicos">
                  {{ getStaffMedicoInitials(esquema.staffMedicoId) }}
                </div>
                <div class="medico-details">
                  <span class="medico-name">{{
                    getStaffMedicoNombre(esquema.staffMedicoId)
                  }}</span>
                  <span class="medico-especialidad">{{
                    getStaffMedicoEspecialidad(esquema.staffMedicoId)
                  }}</span>
                </div>
              </div>
            </td>
            <td>
              <div class="badge-consultorios">
                <i class="fas fa-door-open me-1"></i>
                {{ getConsultorioNombre(esquema.consultorioId) }}
              </div>
            </td>
            <td>
              <div class="badge-centro-atencion">
                <i class="fas fa-hospital me-1"></i>
                {{ getCentroAtencionNombre(esquema.centroId) }}
              </div>
            </td>
            <td>
              <div class="horarios-container">
                <div
                  *ngFor="let horario of esquema.horarios"
                  class="horario-badge"
                >
                  <span class="dia-label">{{ horario.dia }}</span>
                  <span class="hora-range"
                    >{{ horario.horaInicio }} - {{ horario.horaFin }}</span
                  >
                </div>
                <div
                  *ngIf="!esquema.horarios || esquema.horarios.length === 0"
                  class="no-horarios"
                >
                  Sin horarios configurados
                </div>
              </div>
            </td>
            <td>
              <div class="badge-esquema-turno">
                <i class="fas fa-clock me-1"></i>
                {{ esquema.intervalo }} min
              </div>
            </td>
            <td>
              <div class="action-buttons">
                <button
                  class="btn-action btn-edit"
                  (click)="goToEdit(esquema.id); $event.stopPropagation()"
                  title="Editar esquema"
                >
                  <i class="fas fa-edit"></i>
                </button>
                <button
                  class="btn-action btn-delete"
                  (click)="remove(esquema.id); $event.stopPropagation()"
                  title="Eliminar esquema"
                >
                  <i class="fas fa-trash"></i>
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="card-footer">
      <app-pagination
        [totalPages]="resultsPage.totalPages"
        [currentPage]="currentPage"
        (pageChangeRequested)="onPageChangeRequested($event)"
        [number]="resultsPage.number"
        [hidden]="resultsPage.numberOfElements < 1"
      ></app-pagination>
    </div>
  </div>
</div>
