<div class="home-container" [@fadeIn]>
  <!-- Hero Section -->
  <div class="hero-section" [@slideUp]>
    <div class="brand-logo" [@logoWave]>
      <i class="fas fa-calendar-check"></i>
      <h1 class="brand-title">CheTurno</h1>
    </div>
  </div>

  <!-- Registration Section -->
  <div class="login-section">
    <div class="login-card" [@slideUp]>
      <!-- Login Link -->
      <div class="login-link">
        <p>
          ¿Ya estás registrado?
          <a class="login-redirect" 
             [@pulse]="pulseState" 
             (click)="navigateToLogin()">Inicia sesión aquí</a>
        </p>
      </div>
      
      <form class="login-form" #registroForm="ngForm" (ngSubmit)="onSubmit(registroForm)" autocomplete="off" novalidate>
        <div class="form-title">Crea tu cuenta de paciente</div>
        
        <!-- Mensajes de estado -->
        <div class="alert alert-success" *ngIf="successMessage" [@fadeIn]>
          <i class="fas fa-check-circle me-2"></i>
          {{ successMessage }}
        </div>
        
        <div class="alert alert-danger" *ngIf="errorMessage" [@fadeIn]>
          <i class="fas fa-exclamation-circle me-2"></i>
          {{ errorMessage }}
          <button type="button" class="btn-close" (click)="limpiarMensajes()"></button>
        </div>
        
        <div class="form-row">
          <div class="form-group">
            <label for="nombre">Nombre</label>
            <input
              type="text"
              id="nombre"
              name="nombre"
              class="form-control"
              [(ngModel)]="usuario.nombre"
              required
              minlength="2"
              maxlength="50"
              placeholder="Tu nombre"
              #nombre="ngModel"
              (keypress)="onlyText($event)"
              (paste)="validateTextPaste($event)"
            />
            <small class="form-text text-danger" *ngIf="nombre.invalid && nombre.touched">
              El nombre es requerido
            </small>
          </div>
          
          <div class="form-group">
            <label for="apellido">Apellido</label>
            <input
              type="text"
              id="apellido"
              name="apellido"
              class="form-control"
              [(ngModel)]="usuario.apellido"
              required
              minlength="2"
              maxlength="50"
              placeholder="Tu apellido"
              #apellido="ngModel"
              (keypress)="onlyText($event)"
              (paste)="validateTextPaste($event)"
            />
            <small class="form-text text-danger" *ngIf="apellido.invalid && apellido.touched">
              El apellido es requerido
            </small>
          </div>
        </div>

        <div class="form-group">
          <label for="dni">DNI</label>
          <input
            type="text"
            id="dni"
            name="dni"
            class="form-control"
            [(ngModel)]="usuario.dni"
            required
            minlength="7"
            maxlength="10"
            pattern="[0-9]{7,10}"
            placeholder="Ingresa tu DNI (sin puntos)"
            #dni="ngModel"
            (keypress)="onlyNumbers($event)"
            (paste)="validateNumberPaste($event)"
          />
          <small class="form-text text-danger" *ngIf="dni.invalid && dni.touched">
            Campo obligatorio
          </small>
        </div>

        <div class="form-group">
          <label for="telefono">Teléfono:</label>
          <div class="phone-input-container">
            <div>
              <label class="phone-label" for="countryCode">País</label>
              <select 
                id="countryCode" 
                name="countryCode" 
                class="form-control country-select" 
                [(ngModel)]="usuario.codigoPais"
                required
                #countryCode="ngModel"
              >
                <option value="+54">🇦🇷 AR (+54)</option>
                <option value="+55">🇧🇷 BR (+55)</option>
                <option value="+56">🇨🇱 CL (+56)</option>
                <option value="+57">🇨🇴 CO (+57)</option>
                <option value="+598">🇺🇾 UY (+598)</option>
                <option value="+595">🇵🇾 PY (+595)</option>
                <option value="+51">🇵🇪 PE (+51)</option>
                <option value="+58">🇻🇪 VE (+58)</option>
                <option value="+593">🇪🇨 EC (+593)</option>
                <option value="+591">🇧🇴 BO (+591)</option>
                <option value="+1">🇺🇸 US (+1)</option>
                <option value="+34">🇪🇸 ES (+34)</option>
              </select>
            </div>
            <div>
              <label class="phone-label" for="telefono">Número del teléfono móvil</label>
              <input
                type="tel"
                id="telefono"
                name="telefono"
                class="form-control phone-number"
                [(ngModel)]="usuario.telefono"
                required
                pattern="[0-9]{6,10}"
                maxlength="10"
                placeholder="11 2345 6789"
                #telefono="ngModel"
                (keypress)="onlyNumbers($event)"
                (paste)="validateNumberPaste($event)"
              />
            </div>
          </div>
          <small class="form-text">Selecciona el país e ingresa tu número de teléfono</small>
          <small class="form-text text-danger" *ngIf="telefono.invalid && telefono.touched">
            Campo obligatorio
          </small>
        </div>

        <div class="form-group">
          <label for="email">E-Mail</label>
          <input
            type="email"
            id="email"
            name="email"
            class="form-control"
            [(ngModel)]="usuario.email"
            required
            pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$"
            placeholder="tu@email.com"
            title="Ingresa un email válido"
            #email="ngModel"
          />
          <small class="form-text text-danger" *ngIf="email.invalid && email.touched">
            Ingresa un email válido
          </small>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="password">Contraseña</label>
            <input
              type="password"
              id="password"
              name="password"
              class="form-control"
              [(ngModel)]="usuario.password"
              required
              minlength="8"
              placeholder="Contraseña"
              title="Mínimo 8 caracteres, debe incluir letras y números"
              #password="ngModel"
            />
            <small class="form-text">Mínimo 8 caracteres con letras y números</small>
            <small class="form-text text-danger" *ngIf="password.invalid && password.touched">
              La contraseña debe tener al menos 8 caracteres
            </small>
          </div>
          
          <div class="form-group">
            <label for="confirmPassword">Confirmar contraseña</label>
            <input
              type="password"
              id="confirmPassword"
              name="confirmPassword"
              class="form-control"
              [(ngModel)]="usuario.confirmPassword"
              required
              placeholder="Repite la contraseña"
              title="Debe coincidir con la contraseña"
              #confirmPassword="ngModel"
            />
            <small class="form-text">Debe coincidir con la contraseña</small>
            <small class="form-text text-danger" *ngIf="confirmPassword.invalid && confirmPassword.touched">
              Confirma tu contraseña
            </small>
            <small class="form-text text-danger" *ngIf="!passwordsMatch() && confirmPassword.touched">
              Las contraseñas no coinciden
            </small>
          </div>
        </div>

        <div class="form-actions">
          <button 
            type="submit" 
            class="btn btn-register"
            [disabled]="registroForm.invalid || !passwordsMatch() || isLoading"
          >
            <i class="fas fa-spinner fa-spin" *ngIf="isLoading"></i>
            <i class="fas fa-user-check" *ngIf="!isLoading"></i>
            {{ isLoading ? 'Registrando...' : 'Crear Cuenta' }}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
