<div class="modal-overlay">
  <div class="modal-container">
    <!-- Header -->
    <div class="modal-header">
      <h2 class="modal-title">
        <i class="fas fa-user-edit"></i>
        Completar Perfil
      </h2>
      <p class="modal-subtitle">
        Para utilizar el sistema, necesitamos que complete su información personal
      </p>
    </div>

    <!-- Body -->
    <div class="modal-body">
      <!-- Mensaje de bienvenida -->
      <div class="welcome-message">
        <p>
          <i class="fas fa-info-circle text-primary"></i>
          Bienvenido/a. Por favor, complete los siguientes datos para poder acceder a todas las funcionalidades del sistema.
        </p>
      </div>

      <!-- Mensaje de error -->
      <div *ngIf="errorMessage" class="alert alert-danger" role="alert">
        <i class="fas fa-exclamation-triangle"></i>
        {{ errorMessage }}
      </div>

      <!-- Formulario -->
      <form [formGroup]="profileForm" (ngSubmit)="onSubmit()">
        
        <!-- DNI -->
        <div class="form-group mb-3">
          <label for="dni" class="form-label">
            <i class="fas fa-id-card"></i>
            DNI <span class="text-danger">*</span>
          </label>
          <input
            type="number"
            id="dni"
            class="form-control"
            formControlName="dni"
            placeholder="Ej: 12345678"
            [class.is-invalid]="profileForm.get('dni')?.invalid && profileForm.get('dni')?.touched"
          />
          <div class="invalid-feedback" *ngIf="profileForm.get('dni')?.invalid && profileForm.get('dni')?.touched">
            {{ getErrorMessage('dni') }}
          </div>
          <small class="form-text text-muted">
            Ingrese su DNI sin puntos ni espacios
          </small>
        </div>

        <!-- Teléfono -->
        <div class="form-group mb-3">
          <label for="telefono" class="form-label">
            <i class="fas fa-phone"></i>
            Teléfono <span class="text-danger">*</span>
          </label>
          <input
            type="tel"
            id="telefono"
            class="form-control"
            formControlName="telefono"
            placeholder="Ej: 2804123456"
            [class.is-invalid]="profileForm.get('telefono')?.invalid && profileForm.get('telefono')?.touched"
          />
          <div class="invalid-feedback" *ngIf="profileForm.get('telefono')?.invalid && profileForm.get('telefono')?.touched">
            {{ getErrorMessage('telefono') }}
          </div>
          <small class="form-text text-muted">
            Ingrese un número de teléfono válido con código de área
          </small>
        </div>

        <!-- Fecha de Nacimiento -->
        <div class="form-group mb-3">
          <label for="fechaNacimiento" class="form-label">
            <i class="fas fa-calendar-alt"></i>
            Fecha de Nacimiento <span class="text-danger">*</span>
          </label>
          <input
            type="date"
            id="fechaNacimiento"
            class="form-control"
            formControlName="fechaNacimiento"
            [max]="getMaxDate()"
            [class.is-invalid]="profileForm.get('fechaNacimiento')?.invalid && profileForm.get('fechaNacimiento')?.touched"
          />
          <div class="invalid-feedback" *ngIf="profileForm.get('fechaNacimiento')?.invalid && profileForm.get('fechaNacimiento')?.touched">
            {{ getErrorMessage('fechaNacimiento') }}
          </div>
          <small class="form-text text-muted">
            Seleccione su fecha de nacimiento
          </small>
        </div>

        <!-- Obra Social (Opcional) -->
        <div class="form-group mb-4">
          <label for="obraSocialId" class="form-label">
            <i class="fas fa-hospital"></i>
            Obra Social <span class="text-muted">(Opcional)</span>
          </label>
          <select
            id="obraSocialId"
            class="form-select"
            formControlName="obraSocialId"
          >
            <option [value]="null">Sin obra social</option>
            <!-- TODO: Cargar obras sociales desde el backend -->
            <!-- <option *ngFor="let os of obrasSociales" [value]="os.id">{{ os.nombre }}</option> -->
          </select>
          <small class="form-text text-muted">
            Puede seleccionar una obra social o dejarlo sin asignar
          </small>
        </div>

        <!-- Botones de acción -->
        <div class="modal-actions">
          <button
            type="submit"
            class="btn btn-primary btn-lg w-100"
            [disabled]="isSubmitting || profileForm.invalid"
          >
            <span *ngIf="!isSubmitting">
              <i class="fas fa-check"></i>
              Completar Perfil
            </span>
            <span *ngIf="isSubmitting">
              <i class="fas fa-spinner fa-spin"></i>
              Guardando...
            </span>
          </button>
        </div>

        <!-- Nota informativa -->
        <div class="info-note mt-3">
          <p class="mb-0 text-center">
            <i class="fas fa-lock text-muted"></i>
            <small class="text-muted">
              Sus datos están protegidos y solo serán utilizados para gestionar sus turnos médicos
            </small>
          </p>
        </div>
      </form>
    </div>
  </div>
</div>
