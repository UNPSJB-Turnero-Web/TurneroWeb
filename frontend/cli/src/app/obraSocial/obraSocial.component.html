<div class="container-fluid mt-4">
  <div class="modern-card">
    <!-- HEADER NORMALIZADO CON SISTEMA DE COLORES -->
    <div class="banner-obra-social">
      <div class="header-content">
        <div class="title-section">
          <div class="header-icon">
            <i class="fas fa-heart-pulse"></i>
          </div>
          <div class="header-text">
            <h1>Obras Sociales</h1>
            <p>Gestión de obras sociales del sistema</p>
          </div>
        </div>
        <button
          class="btn btn-banner"
          (click)="router.navigate(['/obraSocial/new'])"
        >
          <i class="fas fa-plus me-2"></i>
          Nueva Obra Social
        </button>
      </div>
    </div>

    <!-- BARRA DE FILTROS Y BÚSQUEDA -->
    <div class="card-body">
      <div class="filters-section">
        <h5 class="filters-title">
          <i class="fas fa-filter me-2"></i>
          Filtros de búsqueda
        </h5>

        <div class="row g-3">
          <!-- Filtro por Nombre -->
          <div class="col-md-4">
            <label for="nombreFilter" class="form-label">
              <i class="fas fa-heart-pulse me-1"></i>
              Nombre
            </label>
            <input
              type="text"
              id="nombreFilter"
              class="form-control"
              placeholder="Buscar por nombre"
              [(ngModel)]="filters.nombre"
              (input)="onFilterChange()"
            />
          </div>

          <!-- Filtro por Código -->
          <div class="col-md-4">
            <label for="codigoFilter" class="form-label">
              <i class="fas fa-barcode me-1"></i>
              Código
            </label>
            <input
              type="text"
              id="codigoFilter"
              class="form-control"
              placeholder="Buscar por código"
              [(ngModel)]="filters.codigo"
              (input)="onFilterChange()"
            />
          </div>

          <!-- Ordenamiento -->
          <div class="col-md-2">
            <label for="sortByFilter" class="form-label">
              <i class="fas fa-sort me-1"></i>
              Ordenar por
            </label>
            <select
              id="sortByFilter"
              class="form-select"
              [(ngModel)]="filters.sortBy"
              (change)="onFilterChange()"
            >
              <option value="nombre">Nombre</option>
              <option value="codigo">Código</option>
            </select>
          </div>

          <!-- Dirección de ordenamiento -->
          <div class="col-md-2">
            <label for="sortDirFilter" class="form-label">
              <i class="fas fa-sort-amount-down me-1"></i>
              Dirección
            </label>
            <select
              id="sortDirFilter"
              class="form-select"
              [(ngModel)]="filters.sortDir"
              (change)="onFilterChange()"
            >
              <option value="asc">Ascendente</option>
              <option value="desc">Descendente</option>
            </select>
          </div>
        </div>

        <!-- Botones de control -->
        <div class="filters-controls mt-3">
          <button
            type="button"
            class="btn btn-outline-secondary"
            (click)="clearFilters()"
          >
            <i class="fas fa-times me-2"></i>
            Limpiar filtros
          </button>

          <div class="results-info">
            <span class="badge bg-primary">
              {{ resultsPage.totalElements }} resultado(s) encontrado(s)
            </span>
          </div>
        </div>
      </div>
    </div>

    <!-- TABLA MODERNA NORMALIZADA -->
    <div class="table-container">
      <table class="table modern-table">
        <thead>
          <tr>
            <th>
              <div class="header-cell">
                <div class="icon-circle id-header">
                  <i class="fas fa-hashtag"></i>
                </div>
                ID
              </div>
            </th>
            <th>
              <button
                class="header-button"
                (click)="toggleSort('nombre')"
                [class.active]="filters.sortBy === 'nombre'"
              >
                <div class="header-cell">
                  <div class="icon-circle obra-social-header">
                    <i class="fas fa-heart-pulse"></i>
                  </div>
                  Nombre
                  <i
                    class="fas"
                    [class.fa-sort-up]="
                      filters.sortBy === 'nombre' && filters.sortDir === 'asc'
                    "
                    [class.fa-sort-down]="
                      filters.sortBy === 'nombre' && filters.sortDir === 'desc'
                    "
                    [class.fa-sort]="filters.sortBy !== 'nombre'"
                  >
                  </i>
                </div>
              </button>
            </th>
            <th>
              <button
                class="header-button"
                (click)="toggleSort('codigo')"
                [class.active]="filters.sortBy === 'codigo'"
              >
                <div class="header-cell">
                  <div class="icon-circle obra-social-header">
                    <i class="fas fa-barcode"></i>
                  </div>
                  Código
                  <i
                    class="fas"
                    [class.fa-sort-up]="
                      filters.sortBy === 'codigo' && filters.sortDir === 'asc'
                    "
                    [class.fa-sort-down]="
                      filters.sortBy === 'codigo' && filters.sortDir === 'desc'
                    "
                    [class.fa-sort]="filters.sortBy !== 'codigo'"
                  >
                  </i>
                </div>
              </button>
            </th>
            <th>
              <div class="header-cell">
                <div class="icon-circle obra-social-header">
                  <i class="fas fa-file-text"></i>
                </div>
                Descripción
              </div>
            </th>
            <th>
              <div class="header-cell">
                <div class="icon-circle actions-header">
                  <i class="fas fa-cogs"></i>
                </div>
                Acciones
              </div>
            </th>
          </tr>
        </thead>
        <tbody>
          <tr
            *ngFor="let obraSocial of resultsPage.content || []; let i = index"
            class="table-row"
            [class.even]="i % 2 === 0"
            [class.odd]="i % 2 !== 0"
            (click)="goToDetail(obraSocial.id)"
          >
            <td>
              <span class="badge-obra-social">{{ obraSocial.id }}</span>
            </td>
            <td>
              <div class="obra-social-info">
                <div class="obra-social-name">{{ obraSocial.nombre }}</div>
                <div class="obra-social-type">Obra Social</div>
              </div>
            </td>
            <td>
              <span class="badge-obra-social">{{ obraSocial.codigo }}</span>
            </td>
            <td>
              <div class="descripcion-text">
                {{ obraSocial.descripcion || "Sin descripción" }}
              </div>
            </td>
            <td>
              <div class="action-buttons">
                <button
                  class="btn-action btn-edit"
                  (click)="goToEdit(obraSocial.id); $event.stopPropagation()"
                  title="Editar"
                >
                  <i class="fas fa-edit"></i>
                </button>
                <button
                  class="btn-action btn-delete"
                  (click)="
                    confirmDelete(obraSocial.id); $event.stopPropagation()
                  "
                  title="Eliminar"
                >
                  <i class="fas fa-trash"></i>
                </button>
              </div>
            </td>
          </tr>
          <tr *ngIf="(resultsPage.content || []).length === 0">
            <td colspan="5" class="text-center py-4 text-muted">
              <i class="fas fa-heart-pulse fa-3x mb-3 d-block opacity-50"></i>
              No hay obras sociales registradas
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- PAGINACIÓN -->
  <app-pagination
    [totalPages]="resultsPage.totalPages"
    [currentPage]="currentPage"
    (pageChangeRequested)="onPageChangeRequested($event)"
    [number]="resultsPage.number"
    [hidden]="resultsPage.numberOfElements < 1"
  ></app-pagination>
</div>
